%   Copyright 2016 Emilio Rojas
%
%   Licensed under the Apache License, Version 2.0 (the "License");
%   you may not use this file except in compliance with the License.
%   You may obtain a copy of the License at
%
%       http://www.apache.org/licenses/LICENSE-2.0
%
%   Unless required by applicable law or agreed to in writing, software
%   distributed under the License is distributed on an "AS IS" BASIS,
%   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
%   See the License for the specific language governing permissions and
%   limitations under the License.

\textbf{Caso: $D_1$ on, $D_2$ on}

Se aplica el estado de los diodos.
\begin{align*}
  I_{D1} &> 0
  &
  I_{D2} &> 0
  &
  V_{D1} = V_{D2} &= 0
\end{align*}

\begin{align}
  V_o &= V_i - 1k I_i - 1k I_{D1} - 6 \label{p3:onon:vo1}
  \\
  V_o &= V_i - 3k I_i + 2k I_{D1} + 1k I_{D2} \label{p3:onon:vo2}
  \\
  V_o &= 2k I_{D2} - 1k I_i + 1k I_{D1} \label{p3:onon:vo3}
  \\
  V_o &= 2 + 1k I_i - 1k I_{D2} \label{p3:onon:vo4}
\end{align}

Se obtiene $I_{D1}$ e $I_{D2}$ de \ref{p3:onon:vo1} y \ref{p3:onon:vo3}.

\begin{align*}
  1k I_{D1} &= V_i - 1k I_i - V_o - 6
\end{align*}

\begin{align*}
  2k I_{D2} &= V_o + 1k I_i - 1k I_{D1}
  \\
  2k I_{D2} &= V_o + 1k I_i - 1k \frac{V_i - 1k I_i - V_o - 6}{1k}
  \\
  2k I_{D2} &= V_o + 1k I_i - V_i + 1k I_i + V_o + 6
  \\
  2k I_{D2} &= 2 V_o + 2k I_i - V_i + 6
  \end{align*}

Se obtiene $I_i$ de \ref{p3:onon:vo2}

\begin{align*}
  V_o &= V_i - 3k I_i + 2k I_{D1} + 1k I_{D2}
  \\
  V_o &= V_i - 3k I_i +
    2 \left(V_i - 1k I_i - V_o - 6\right) +
    \frac{2 V_o + 2k I_i - V_i + 6}{2}
  \\
  V_o &= V_i \left(1+2-\frac{1}{2}\right) +
    I_i \left(1k-3k-2k\right) +
    V_o \left(1-2\right)
    -12 + 3
  \\
  V_o &= \frac{5}{2} V_i - 4k I_i - V_o - 9
  \\
  4k I_i &= {\frac{5}{2} V_i - 2 V_o - 9}
\end{align*}

Se remplaza $I_i$ en $I_{D1}$ e $I_{D2}$

\begin{align*}
  1k I_{D1} &= V_i - \left(\frac{{\frac{5}{2} V_i - 2 V_o - 9}}{4}\right) - V_o - 6
  \\
  &= V_i - \left({\frac{5}{8} V_i - \frac{1}{2} V_o - \frac{9}{4}}\right) - V_o - 6
  \\
  &= V_i - \frac{5}{8} V_i + \frac{1}{2} V_o + \frac{9}{4} - V_o - 6
  \\
  &= \frac{3}{8} V_i - \frac{1}{2} V_o - \frac{15}{4}
\end{align*}
\begin{align*}
  2k I_{D2} &=
    2 V_o +
    2 \left(\frac{{\frac{5}{2} V_i - 2 V_o - 9}}{4}\right) -
    V_i + 6
  \\
  &= 2 V_o + \frac{5}{4} V_i - V_o - \frac{9}{2} - V_i + 6
  \\
  &= V_o + \frac{1}{4} V_i + \frac{3}{2}
  \end{align*}

Se obtiene $V_o$ en funciÃ³n de $V_i$ con \ref{p3:onon:vo4}

\begin{align*}
  V_o &= 2 + 1k I_i - 1k I_{D2}
  \\
  V_o &= 2 +
    \frac{3}{8} V_i - \frac{1}{2} V_o - \frac{15}{4} -
    \left(\frac{V_o + \frac{1}{4} V_i + \frac{3}{2}}{2}\right)
  \\
  V_o &= 2 +
    \frac{3}{8} V_i - \frac{1}{2} V_o - \frac{15}{4} -
    \frac{1}{2} V_o - \frac{1}{8} V_i - \frac{3}{4}
  \\
  V_o &= \frac{1}{4} V_i - V_o - \frac{5}{2}
  \\
  V_o &= \frac{1}{8} V_i - \frac{5}{4}
\end{align*}

Se aplican restricciones para obtener rango de funcionamiento.

\begin{align*}
  1k I_{D1} = \frac{3}{8} V_i - \frac{1}{2} V_o - \frac{15}{4} &> 0
  \\
  \frac{3}{8} V_i - \frac{1}{2} V_o &> \frac{15}{4}
  \\
  \frac{3}{8} V_i - \frac{1}{2} \left(\frac{1}{8} V_i - \frac{5}{4}\right) &> \frac{15}{4}
  \\
  \frac{3}{8} V_i - \frac{1}{16} V_i + \frac{5}{8} &> \frac{15}{4}
  \\
  \frac{5}{16} V_i &> \frac{25}{8}
  \\
  V_i &> 10
\end{align*}
\begin{align*}
  2k I_{D2} = V_o + \frac{1}{4} V_i + \frac{3}{2} &> 0
  \\
  \frac{1}{8} V_i - \frac{5}{4} + \frac{1}{4} V_i &> -\frac{3}{2}
  \\
  \frac{3}{8} V_i &> -\frac{1}{4}
  \\
  V_i &> -\frac{2}{3}
\end{align*}
